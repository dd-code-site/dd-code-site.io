(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{520:function(s,e,t){"use strict";t.r(e);var a=t(6),n=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("首先，复习一下索引的创建：")]),s._v(" "),t("p",[s._v("普通的索引的创建")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("自定义"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("索引名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" 数据表"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("字段"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("复合索引的创建")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("自定义"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("索引名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" 数据表"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("字段，字段，。。。"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("删除索引")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" 索引名\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("以下通过 explain 显示出 mysql 执行的字段内容：")]),s._v(" "),t("ul",[t("li",[s._v("id: SELECT 查询的标识符. 每个 SELECT 都会自动分配一个唯一的标识符.")]),s._v(" "),t("li",[s._v("select_type: SELECT 查询的类型.")]),s._v(" "),t("li",[s._v("table: 查询的是哪个表")]),s._v(" "),t("li",[s._v("partitions: 匹配的分区")]),s._v(" "),t("li",[s._v("type: join 类型")]),s._v(" "),t("li",[s._v("possible_keys: 此次查询中可能选用的索引")]),s._v(" "),t("li",[s._v("key: 此次查询中确切使用到的索引")]),s._v(" "),t("li",[s._v("ref: 哪个字段或常数与 key 一起被使用")]),s._v(" "),t("li",[s._v("rows: 显示此查询一共扫描了多少行. 这个是一个估计值.")]),s._v(" "),t("li",[s._v("filtered: 表示此查询条件所过滤的数据的百分比")]),s._v(" "),t("li",[s._v("extra: 额外的信息")])]),s._v(" "),t("p",[s._v("索引查询失效的几个情况：")]),s._v(" "),t("p",[s._v("1、like 以%开头，索引无效；当like前缀没有%，后缀有%时，索引有效。")]),s._v(" "),t("p",[s._v("2、or语句前后没有同时使用索引。当or左右查询字段只有一个是索引，该索引失效，只有当or左右查询字段均为索引时，才会生效")]),s._v(" "),t("p",[s._v("3、组合索引，不是使用第一列索引，索引失效")]),s._v(" "),t("p",[s._v("4、数据类型出现隐式转化。如varchar不加单引号的话可能会自动转换为int型，使索引无效，产生全表扫描。")]),s._v(" "),t("p",[s._v("5、在索引列上使用 IS NULL 或 IS NOT NULL操作。索引是不索引空值的，所以这样的操作不能使用索引，可以用其他的办法处理，例如：数字类型，判断大于0，字符串类型设置一个默认值，判断是否等于默认值即可。")]),s._v(" "),t("p",[s._v("6、在索引字段上使用not，<>，!=。不等于操作符是永远不会用到索引的，因此对它的处理只会产生全表扫描。 优化方法： key<>0 改为 key>0 or key<0。")]),s._v(" "),t("p",[s._v("7、对索引字段进行计算操作、字段上使用函数。（索引为 emp(ename,empno,sal)）")]),s._v(" "),t("p",[s._v("8、当全表扫描速度比索引速度快时，mysql会使用全表扫描，此时索引失效。")]),s._v(" "),t("p",[s._v("索引失效分析工具：")]),s._v(" "),t("p",[s._v("可以使用 explain 命令加在要分析的 sql 语句前面，在执行结果中查看 key 这一列的值，如果为 NULL，说明没有使用索引。")]),s._v(" "),t("p",[s._v("explain 命令的详细用法，可以查看这篇文章：https://segmentfault.com/a/1190000008131735")])])}),[],!1,null,null,null);e.default=n.exports}}]);