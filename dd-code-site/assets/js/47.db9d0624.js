(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{543:function(a,s,t){"use strict";t.r(s);var n=t(6),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"nginx-是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-是什么"}},[a._v("#")]),a._v(" nginx 是什么？")]),a._v(" "),t("p",[a._v("nginx 是一个高性能的 HTTP 和反向代理服务器，也是一个 IMAP/POP3/SMTP 服务器。")]),a._v(" "),t("p",[a._v("php-fpm 是什么？")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://www.yuque.com/docs/share/ccf6de87-098c-4e78-a09a-79613d3cc9f1?#",target:"_blank",rel:"noopener noreferrer"}},[a._v("《PHP-FPM 是什么？》"),t("OutboundLink")],1)]),a._v(" "),t("p",[a._v("要明白 nginx 和 php-fpm 是怎么结合的，首先要清楚之间是怎么配置在一起的，主要有三处：")]),a._v(" "),t("h2",{attrs:{id:"第一处-虚拟机-server-的配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第一处-虚拟机-server-的配置"}},[a._v("#")]),a._v(" "),t("strong",[a._v("第一处：虚拟机 server 的配置")])]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("server "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    listen       "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#监听80端口，接收http请求")]),a._v("\n    server_name  www.example.com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#就是网站地址")]),a._v("\n    root /usr/local/etc/nginx/www/huxintong_admin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 准备存放代码工程的路径")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#路由到网站根目录www.example.com时候的处理")]),a._v("\n    location / "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        index index.php"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#跳转到www.example.com/index.php")]),a._v("\n        autoindex on"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("   \n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#当请求网站下php文件的时候，反向代理到php-fpm")]),a._v("\n    location ~ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v(".php$ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        include  fastcgi_params"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#加载nginx的fastcgi模块")]),a._v("\n        fastcgi_pass   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:9000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#nginx fastcgi进程监听的IP地址和端口")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br")])]),t("h2",{attrs:{id:"第二处-fastcgi-conf-的配置-这个配置主要是把-nginx-中的变量-解释为-php-能够理解的变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第二处-fastcgi-conf-的配置-这个配置主要是把-nginx-中的变量-解释为-php-能够理解的变量"}},[a._v("#")]),a._v(" "),t("strong",[a._v("第二处：fastcgi.conf 的配置，这个配置主要是把 nginx 中的变量，解释为 PHP 能够理解的变量：")])]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("fastcgi_param  SCRIPT_FILENAME    "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$document_root")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$fastcgi_script_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  QUERY_STRING       "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$query_string")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  REQUEST_METHOD     "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$request_method")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  CONTENT_TYPE       "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$content_type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  CONTENT_LENGTH     "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$content_length")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nfastcgi_param  SCRIPT_NAME        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$fastcgi_script_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  REQUEST_URI        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$request_uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  DOCUMENT_URI       "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$document_uri")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  DOCUMENT_ROOT      "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$document_root")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  SERVER_PROTOCOL    "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$server_protocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  HTTPS              "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$https")]),a._v(" if_not_empty"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nfastcgi_param  GATEWAY_INTERFACE  CGI/1.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  SERVER_SOFTWARE    nginx/"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$nginx_version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\nfastcgi_param  REMOTE_ADDR        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$remote_addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  REMOTE_PORT        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$remote_port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  SERVER_ADDR        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$server_addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  SERVER_PORT        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$server_port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nfastcgi_param  SERVER_NAME        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$server_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# PHP only, required if PHP was built with --enable-force-cgi-redirect")]),a._v("\nfastcgi_param  REDIRECT_STATUS    "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("200")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br"),t("span",{staticClass:"line-number"},[a._v("23")]),t("br"),t("span",{staticClass:"line-number"},[a._v("24")]),t("br")])]),t("h2",{attrs:{id:"第三处-php-fpm-conf-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第三处-php-fpm-conf-配置"}},[a._v("#")]),a._v(" "),t("strong",[a._v("第三处：php-fpm.conf 配置")])]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("listen "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:9000\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[a._v("#")]),a._v(" 总结：")]),a._v(" "),t("p",[a._v("nginx 是通过 fastcgi_pass 指令调用 php-fpm 的监听端口。")]),a._v(" "),t("h2",{attrs:{id:"完整流程图如下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#完整流程图如下"}},[a._v("#")]),a._v(" 完整流程图如下：")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2020/svg/282255/1595410597804-a74a7b6a-c474-4512-9a03-4c51a529dfff.svg",alt:"img"}})]),a._v(" "),t("h2",{attrs:{id:"资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#资料"}},[a._v("#")]),a._v(" 资料：")]),a._v(" "),t("p",[a._v("https://www.cnblogs.com/luoahong/articles/9139888.html")]),a._v(" "),t("p",[a._v("https://www.jianshu.com/p/aff916a26940")]),a._v(" "),t("p",[a._v("https://zhuanlan.zhihu.com/p/111508553")]),a._v(" "),t("p",[a._v("​")])])}),[],!1,null,null,null);s.default=e.exports}}]);