(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{517:function(e,t,_){"use strict";_.r(t);var v=_(6),a=Object(v.a)({},(function(){var e=this,t=e.$createElement,_=e._self._c||t;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h2",{attrs:{id:"索引"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#索引"}},[e._v("#")]),e._v(" 索引")]),e._v(" "),_("h3",{attrs:{id:"mysql-不同的存储引擎"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#mysql-不同的存储引擎"}},[e._v("#")]),e._v(" MySQL 不同的存储引擎")]),e._v(" "),_("p",[_("img",{attrs:{src:"http://phpmianshiwang-s2.test.upcdn.net/PicGo/20201110143846.png",alt:""}})]),e._v(" "),_("h3",{attrs:{id:"innodb-b-tree-索引实现"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#innodb-b-tree-索引实现"}},[e._v("#")]),e._v(" InnoDB B+Tree 索引实现")]),e._v(" "),_("p",[e._v("主键索引（聚集索引）：")]),e._v(" "),_("ul",[_("li",[e._v("叶子节点 "),_("code",[e._v("data")]),e._v(" 域保存了完整的数据的地址")]),e._v(" "),_("li",[e._v("主键和数据完全存在一棵树上")]),e._v(" "),_("li",[e._v("Root 节点常驻内存")]),e._v(" "),_("li",[e._v("每个非叶子节点一个 "),_("code",[e._v("innodb_page_size")]),e._v(" 大小，加速磁盘 "),_("code",[e._v("IO")])]),e._v(" "),_("li",[e._v("磁盘的 "),_("code",[e._v("IO")]),e._v(" 要比内存慢几百倍，而磁盘慢的原因在于机械设备寻找磁盘慢，因此采用磁盘预读，每次读取一个磁盘页（计算机管理存储器的逻辑快-通常为4k）的整倍数")]),e._v(" "),_("li",[e._v("如果没有主键，MySQL 默认生成隐含字段作为主键，这个字段长度为 6 个字节，类型为长整形")]),e._v(" "),_("li",[e._v("辅助索引结构和主索引相同，但叶子节点 "),_("code",[e._v("data")]),e._v(" 域保存的是主键指针")]),e._v(" "),_("li",[e._v("InnnoDB 以表空间 Tablespace（idb文件）结构进行组织，每个 Tbalespace 包含多个 Segment 段")]),e._v(" "),_("li",[e._v("每个段（分为2种段：叶子节点 Segment & 非叶子节点 Segment），一个 Segment 段包含多个 Extent")]),e._v(" "),_("li",[e._v("一个 Extent 占用 1M 空间包含 64 个 Page（每个Page 16k），InnoDB 的 B-Tree 一个逻辑节点就分配一个物理 Page，一个节点一次 IO 操作")]),e._v(" "),_("li",[e._v("一个 Page 里包含很多有序数据 Row 行数据，Row 行数据中包含 Filed 属性数据等信息")])]),e._v(" "),_("p",[e._v("InnoDB 存储引擎中页的大小为 16KB，一般表的主键类型为 INT（占用4个字节）或 BIGINT（占用8个字节），指针类型也一般为4或8个字节，也就是说一个页（B+Tree中的节点）中大概存储 16KB/(8B+8B)=1k个键值（因为是估值，为方便计算，这里的K的取值为[10]^3）.")]),e._v(" "),_("p",[e._v("也就是说一个深度为 3 的 "),_("code",[e._v("B+Tree")]),e._v(" 索引可以维护 "),_("code",[e._v("10^3 * 10^3 * 10^3=10")]),e._v(" 亿条记录。")]),e._v(" "),_("p",[_("img",{attrs:{src:"http://phpmianshiwang-s2.test.upcdn.net/PicGo/20201110150352.png",alt:""}})]),e._v(" "),_("p",[e._v("每个索引的左指针都是比自己小的 索引/节点，右指针是大于自己的 索引/节点。")])])}),[],!1,null,null,null);t.default=a.exports}}]);